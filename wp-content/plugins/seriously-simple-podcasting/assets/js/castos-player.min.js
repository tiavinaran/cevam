"use strict";function docReady(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}docReady(function(){let e=document.querySelectorAll(".castos-player");e.forEach(function(t){let s=t.dataset.player_id,r=window["ssp_castos_player_"+s],n=t.dataset.episode,e=t.querySelector(".ssp-playback"),i,c=t.querySelector(".play-btn"),a=t.querySelector(".pause-btn"),o=t.querySelector(".player__artwork"),l=t.querySelector(".ssp-duration"),d=t.querySelector(".ssp-timer"),u=t.querySelector(".ssp-progress"),p=t.querySelector(".progress__filled"),y=e.querySelectorAll("[data-skip]"),f=t.querySelector(".player-btn__volume"),v=t.querySelector(".player-btn__speed"),m=t.querySelector(".ssp-loader"),L=t.querySelector(".playlist__items"),_=t.querySelector(".player__podcast-title"),E=t.querySelector(".player__episode-title"),S=t.querySelector(".playlist__wrapper"),h=!!S,q,k;function b(e){return(""+(e+100)).substring(1)}function g(e){var t=Math.floor(e/3600);e%=3600;let n=Math.floor(e/60),i=Math.floor(e%60),s=0;return s=0<t?b(t)+" : "+b(n)+" : "+b(i):b(n)+":"+b(i),s}function T(){clearTimeout(k),k=setTimeout(function(){i.paused?(i.play(),x()):w()},100)}function w(){i.pause(),x()}function x(){i.paused?(a.classList.add("hide"),c.classList.remove("hide")):(a.classList.remove("hide"),c.classList.add("hide"))}function M(){l.innerHTML=g(i.duration)}function C(){var e=i.currentTime/i.duration*100;p.style.flexBasis=e+"%"}function H(e){i.currentTime=e.offsetX/u.offsetWidth*i.duration}function A(){i.currentTime+=parseFloat(this.dataset.skip)}function R(){m.classList.remove("hide")}function O(){m.classList.add("hide")}function F(){O(),i=t.querySelector(".clip-"+n),i.addEventListener("play",x),i.addEventListener("pause",x),i.addEventListener("playing",x),i.addEventListener("playing",M),i.addEventListener("timeupdate",C),i.ontimeupdate=function(){d.innerHTML=g(i.currentTime)},i.onended=function(){a.classList.add("hide"),c.classList.remove("hide");let e=t.querySelector(".playlist__item.active");if(e){e.classList.remove("active");let t=e.nextElementSibling;if(t){let e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),t.dispatchEvent(e)}}},i.addEventListener("waiting",R),i.addEventListener("canplay",O)}c.addEventListener("click",T),a.addEventListener("click",T),o.addEventListener("click",T),v.addEventListener("click",function(){var e=this.dataset.speed<2?(parseFloat(this.dataset.speed)+.2).toFixed(1):.4;v.setAttribute("data-speed",e),v.innerHTML=e+"x",i.playbackRate=e}),y.forEach(function(e){return e.addEventListener("click",A)}),f.addEventListener("click",function(){1===i.volume?(i.volume=0,f.classList.add("off")):(i.volume=1,f.classList.remove("off"))});let j=!1;u.addEventListener("click",H),u.addEventListener("mousemove",function(e){return j&&H(e)}),u.addEventListener("mousedown",function(){return j=!0}),u.addEventListener("mouseup",function(){return j=!1});let J=t.querySelector(".subscribe-btn"),N=t.querySelector(".player-panels .subscribe"),X=t.querySelector(".player-panels .subscribe .close-btn"),B=t.querySelector(".share-btn"),D=t.querySelector(".player-panels .share"),G=t.querySelector(".player-panels .share .close-btn"),P=t.querySelector(".input-link"),U=t.querySelector(".copy-link"),W=t.querySelector(".input-embed"),z=t.querySelector(".copy-embed"),I=t.querySelector(".input-rss"),K=t.querySelector(".copy-rss");function Q(e){e.classList.contains("open")?e.classList.remove("open"):(e.classList.add("open"),e.focus())}function V(e){e.select(),document.execCommand("Copy")}function Y(){var e,t;this.dataset.episode!==n&&(L.querySelectorAll(".playlist__item").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),e=this.querySelector(".playlist__episode-title"),t=this.querySelector(".playlist__item__cover img"),_.textContent=e.dataset.podcast,E.textContent=e.textContent,o.querySelector("img").src=t.src,w(),n=this.dataset.episode,F(),setTimeout(function(){T()},500))}function Z(){function i(){q.style.display="none",S.dataset.processing=""}S.dataset.processing||q.scrollHeight-q.scrollTop!==q.clientHeight||function(){q.style.display="block",S.dataset.processing="1";let e=new XMLHttpRequest,t=new URL(r.ajax_url);var n={action:"get_playlist_items",atts:JSON.stringify(r.atts),page:++S.dataset.page,player_id:s,nonce:r.nonce};Object.keys(n).forEach(function(e){t.searchParams.set(e,n[e])}),e.open("GET",t.toString(),!0),e.onload=function(){if(200===this.status){let e=JSON.parse(this.response);0<e.data.length?e.data.forEach(function(e){let t=function(e){let t=document.createElement("div");return t.innerHTML='<li class="playlist__item" data-episode="'+e.episode_id+'"><div class="playlist__item__cover"><img src="'+e.album_art.src+'" title="'+e.title+'" alt="'+e.title+'" /></div><div class="playlist__item__details"><h2 class="playlist__episode-title" data-podcast="'+e.podcast_title+'">'+e.title+"</h2><p>"+e.date+" â€¢ "+e.duration+'</p><p class="playlist__episode-description">'+e.excerpt+'</p></div><audio preload="none" class="clip clip-'+e.episode_id+'"><source src="'+e.audio_file+'"></audio></li>',t.firstChild}(e);L.appendChild(t),t.addEventListener("click",Y)}):S.removeEventListener("scroll",Z)}i()},e.onerror=function(){i()},e.send()}()}J&&J.addEventListener("click",function(){return Q(N)}),X&&X.addEventListener("click",function(){return Q(N)}),B&&B.addEventListener("click",function(){return Q(D)}),G&&G.addEventListener("click",function(){return Q(D)}),U&&U.addEventListener("click",function(){return V(P)}),z&&z.addEventListener("click",function(){return V(W)}),K&&K.addEventListener("click",function(){return V(I)}),document.addEventListener("keyup",e=>{document.activeElement.closest(".castos-player")&&("ArrowRight"!==e.code?"ArrowLeft"!==e.code?"Space"===e.code&&c.dispatchEvent(new Event("click")):i.currentTime-=10:i.currentTime+=10)}),h&&(q=S.querySelector(".loader"),function(){let e=L.querySelectorAll(".playlist__item");e&&e.forEach(function(e){e.addEventListener("click",Y)}),S&&S.addEventListener("scroll",Z)}()),F()})});